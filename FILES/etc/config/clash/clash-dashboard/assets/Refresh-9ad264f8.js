import{r as p,u,j as r}from"./index-969cf72a.js";import{s as o}from"./Rec.module-c7e11c0c.js";function x(){const[a,t]=p.useState(!1),{t:e}=u();async function l(){t(!0);try{if(!window.confirm(e("confirm_refresh"))){t(!1);return}const c=Math.floor(Date.now()/1e3),i=await fetch(`./stamp.json?=${c}`);if(!i.ok)throw new Error("Failed to fetch stamp");const{stamp:f}=await i.json(),h="PaoPaoGateWay",s=JSON.parse(localStorage.getItem(h));if(!s||!s.clashAPIConfigs||!s.clashAPIConfigs[0].secret)throw new Error("Secret not found");const d=s.clashAPIConfigs[0].secret,m=sha256(f+d);if(!(await fetch(`./${m}reload.json?=${c}`)).ok)throw new Error("Reload failed");alert(e("refresh_success"))}catch(n){console.error(n),alert(e("refresh_fail"))}finally{t(!1)}}return r.jsxs("div",{className:o.body,children:[" ",r.jsx("h1",{className:o.oh1,children:e("refresh_title")}),r.jsx("h3",{className:o.h3,children:e("refresh_tips")}),r.jsx("button",{onClick:l,disabled:a,className:o.link,children:e(a?"loading":"Refresh")})]})}export{x as default};
